<!DOCTYPE html>
<html lang="pt">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>caderninho</title>
    
    <script src="https://cdn.jsdelivr.net/npm/page-flip/dist/js/page-flip.browser.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore-compat.js"></script>

    <style>
        /* --- ESTILO VISUAL --- */
        body {
            margin: 0; padding: 0;
            background-color: #2c2c2c;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            display: flex; justify-content: center; align-items: center;
            height: 100vh; overflow: hidden; color: white;
            flex-direction: column;
        }

        .screen-container {
            text-align: center; z-index: 100;
            background: rgba(0,0,0,0.9);
            padding: 40px; border-radius: 12px;
            max-width: 400px; width: 90%;
            box-shadow: 0 4px 20px rgba(0,0,0,0.6);
            border: 1px solid #444;
        }
        
        h2 { margin-top: 0; color: #ffd700; margin-bottom: 20px; }
        p { line-height: 1.5; color: #ddd; }

        button {
            background-color: #4285F4; color: white;
            border: none; padding: 12px 25px;
            font-size: 16px; border-radius: 6px; cursor: pointer; margin-top: 20px;
            transition: 0.3s; font-weight: bold;
        }
        button:hover { background-color: #357ae8; transform: translateY(-2px); }

        /* --- O LIVRO --- */
        .flip-book { 
            display: none; 
            box-shadow: 0 0 40px rgba(0,0,0,0.8); 
        }
        
        .page { 
            background-color: #fdfaf7; 
            overflow: hidden; 
            border-right: 1px solid #ddd;
        }
        
        .page img { 
            width: 100%; height: 100%; 
            object-fit: contain; 
            display: block;
        }
    </style>
</head>
<body>

    <div id="login-screen" class="screen-container">
        <h2>üîê caderninho</h2>
        <p>Fa√ßa login com o Google para acessar.</p>
        <button id="btn-login">Entrar com Google</button>
    </div>

    <div id="book" class="flip-book">
        <div class="page"><img src="imagens/01.JPG" loading="lazy"></div>
        <div class="page"><img src="imagens/02.JPG" loading="lazy"></div>
        <div class="page"><img src="imagens/03.JPG" loading="lazy"></div>
        <div class="page"><img src="imagens/04.JPG" loading="lazy"></div>
        <div class="page"><img src="imagens/05.JPG" loading="lazy"></div>
        <div class="page"><img src="imagens/06.JPG" loading="lazy"></div>
        <div class="page"><img src="imagens/07.JPG" loading="lazy"></div>
        <div class="page"><img src="imagens/08.JPG" loading="lazy"></div>
        <div class="page"><img src="imagens/09.JPG" loading="lazy"></div>
        <div class="page"><img src="imagens/10.JPG" loading="lazy"></div>
        <div class="page"><img src="imagens/11.JPG" loading="lazy"></div>
        <div class="page"><img src="imagens/12.JPG" loading="lazy"></div>
        <div class="page"><img src="imagens/13.JPG" loading="lazy"></div>
        <div class="page"><img src="imagens/14.JPG" loading="lazy"></div>
        <div class="page"><img src="imagens/15.JPG" loading="lazy"></div>
        <div class="page"><img src="imagens/16.JPG" loading="lazy"></div>
        <div class="page"><img src="imagens/17.JPG" loading="lazy"></div>
        <div class="page"><img src="imagens/18.JPG" loading="lazy"></div>
        <div class="page"><img src="imagens/19.JPG" loading="lazy"></div>
        <div class="page"><img src="imagens/20.JPG" loading="lazy"></div>
        <div class="page"><img src="imagens/21.JPG" loading="lazy"></div>
        <div class="page"><img src="imagens/22.JPG" loading="lazy"></div>
        <div class="page"><img src="imagens/23.JPG" loading="lazy"></div>
        <div class="page"><img src="imagens/24.JPG" loading="lazy"></div>
        <div class="page"><img src="imagens/25.JPG" loading="lazy"></div>
        <div class="page"><img src="imagens/26.JPG" loading="lazy"></div>
        <div class="page"><img src="imagens/27.JPG" loading="lazy"></div>
        <div class="page"><img src="imagens/28.JPG" loading="lazy"></div>
    </div>

    <script>
        // --- SUA CONFIGURA√á√ÉO DO FIREBASE ---
        const firebaseConfig = {
            apiKey: "AIzaSyB-musBHXYPTBMt8VK1-Y-JGHlhZotihhY",
            authDomain: "diarioseguro-5d091.firebaseapp.com",
            projectId: "diarioseguro-5d091",
            storageBucket: "diarioseguro-5d091.firebasestorage.app",
            messagingSenderId: "454780146306",
            appId: "1:454780146306:web:a52ff824e85e996b6cda9b"
        };

        firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();
        const db = firebase.firestore();
        const provider = new firebase.auth.GoogleAuthProvider();

        const loginScreen = document.getElementById('login-screen');
        const bookElement = document.getElementById('book');
        let pageFlip;

        // 1. Bot√£o de Login
        document.getElementById('btn-login').addEventListener('click', () => {
            auth.signInWithPopup(provider).catch(err => alert("Erro: " + err.message));
        });

        // 2. Monitoramento e REGISTRO (LOG)
        auth.onAuthStateChanged(async (user) => {
            if (user) {
                // Usu√°rio entrou!
                loginScreen.style.display = 'none';
                
                // Registra o acesso no banco
                registrarAcesso(user);

                // Mostra o livro direto
                carregarLivro();
            } else {
                loginScreen.style.display = 'block';
                bookElement.style.display = 'none';
            }
        });

        // Fun√ß√£o que grava no banco de dados
        function registrarAcesso(user) {
            db.collection('acessos').add({
                nome: user.displayName,
                email: user.email,
                data: new Date(),
                navegador: navigator.userAgent
            }).catch(err => {
                console.error("Erro ao registrar acesso:", err);
            });
        }

        function carregarLivro() {
            bookElement.style.display = 'block';

            if (!pageFlip) {
                pageFlip = new St.PageFlip(document.getElementById('book'), {
                    width: 400, height: 600, size: 'stretch',
                    minWidth: 300, maxWidth: 800,
                    minHeight: 400, maxHeight: 1000,
                    showCover: true, mobileScrollSupport: false
                });
                pageFlip.loadFromHTML(document.querySelectorAll('.page'));
            }
        }
    </script>
</body>
</html>
